%--------------------------------------------------------------------
% PURPOSE:
% 
% This routine computes the coefficients of the Q2 Lagrange shape 
% functions on the reference element [-1,1]x[-1,1].
%
% Author:
% Paola Antonietti
%--------------------------------------------------------------------

function [coef]= matrix_coeff_Q3(nln)

% nln = 16

coef=zeros(nln,nln);

%   x^3   y^3   x^3y^3  x^3y^2  x^3y   xy^3   x^2y^3  x^2    y^2   x^2y^2  x^2y   y^2x      x      y      xy      c 
M= [-1     1     -1      -1      -1     -1      1      1      1      1      1      -1      -1      1      -1      1 % (-1,1)
    -1    1/8    -1/8    -1/4    -1/2   -1/8    1/8    1      1/4    1/4    1/2    -1/2    -1      1/2    -1/2    1 % (-1,0.5)
    -1   -1/8    1/8     -1/4    1/2     1/8   -1/8    1      1/4    1/4   -1/2    -1/2    -1     -1/2     1/2    1 % (-1,-0.5)
    -1    -1      1      -1       1      1     -1      1      1      1     -1      -1      -1     -1       1      1 % (-1,-1)
    -1/8  -1     1/8     -1/8    1/8     1/2   -1/4    1/4    1      1/4   -1/4    -1/2    -1/2   -1       1/2    1 % (-0.5,-1)
    -1/8  -1/8   1/64    -1/32   1/16    1/16  -1/32   1/4    1/4    1/16  -1/8    -1/8    -1/2   -1/2     1/4    1 % (-0.5,-0.5)
    -1/8  1/8   -1/64    -1/32  -1/16   -1/16   1/32   1/4    1/4    1/16   1/8    -1/8    -1/2    1/2    -1/4    1 % (-0.5,0.5)
    -1/8   1    -1/8     -1/8   -1/8    -1/2    1/4    1/4    1      1/4    1/4    -1/2    -1/2    1      -1/2    1 % (-0.5,1)
    1/8    1     1/8      1/8    1/8     1/2    1/4    1/4    1      1/4    1/4     1/2     1/2    1       1/2    1 % (0.5,1)
    1/8   1/8    1/64     1/32   1/16    1/16   1/32   1/4    1/4    1/16   1/8     1/8     1/2    1/2     1/4    1 % (0.5,0.5)
    1/8  -1/8   -1/64     1/32  -1/16   -1/16  -1/32   1/4    1/4    1/16  -1/8     1/8     1/2   -1/2    -1/4    1 % (0.5,-0.5)
    1/8   -1    -1/8      1/8   -1/8    -1/2   -1/4    1/4    1      1/4   -1/4     1/2     1/2   -1      -1/2    1 % (0.5,-1)
     1    -1     -1       1     -1      -1     -1      1      1      1      -1      1       1     -1      -1      1 % (1,-1) 
     1   -1/8   -1/8      1/4   -1/2    -1/8   -1/8    1      1/4    1/4   -1/2     1/2     1     -1/2    -1/2    1 % (1,-0.5)
     1    1/8    1/8      1/4    1/2     1/8    1/8    1      1/4    1/4    1/2     1/2     1      1/2     1/2    1 % (1, 0.5)
     1     1      1       1      1       1      1      1      1      1      1       1       1      1       1      1 % (1,1)     
];

for i=1:nln
    f=zeros(nln,1);
    f(i)=1;
    coef(:,i)=M\f;
end

end
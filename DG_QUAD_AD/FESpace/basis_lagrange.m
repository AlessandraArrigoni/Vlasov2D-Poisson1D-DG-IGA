%--------------------------------------------------------------------
% PURPOSE:
%
% This routine generates a structure containing the scalar-valued Lagrange
% shape functions (and their derivatives) for P^k discontinuous finite
% elements with k=1,2,3 and for Q^k with k = 1,2,3
%
% Author:
% Paola Antonietti
%--------------------------------------------------------------------

function [basis]= basis_lagrange(fem)

fprintf('Compute the shape functions elements: %s\n', fem);

switch fem
    case 'P1'
        nln=3;
        [c]= matrix_coeff_P1(nln);
        basis=struct('num',nln,...
            'n_edge',3,...
            'coeff',c,...
            'fbasis',{'c(1,1).*csi + c(2,1).*eta + c(3,1)',...
            'c(1,2).*csi + c(2,2).*eta + c(3,2)',...
            'c(1,3).*csi + c(2,3).*eta + c(3,3)'},...
            'Gbasis_1',{'c(1,1).*1 + 0     .*eta + 0',...
            'c(1,2).*1 + 0     .*eta + 0',...
            'c(1,3).*1 + 0     .*eta + 0'},...
            'Gbasis_2',{'0     .*csi + c(2,1).*1   + 0',...
            '0     .*csi + c(2,2).*1   + 0',...
            '0     .*csi + c(2,3).*1   + 0'});

    case 'P2'
        nln=6;
        [c]= matrix_coeff_P2(nln);
        basis=struct('num',nln,...
            'n_edge',6,...
            'coeff',c,...
            'fbasis',{'c(1,1).*csi.^2 + c(2,1).*eta.^2 + c(3,1).*csi.*eta + c(4,1).*csi + c(5,1).*eta  + c(6,1)',...
            'c(1,2).*csi.^2 + c(2,2).*eta.^2 + c(3,2).*csi.*eta + c(4,2).*csi + c(5,2).*eta  + c(6,2)',...
            'c(1,3).*csi.^2 + c(2,3).*eta.^2 + c(3,3).*csi.*eta + c(4,3).*csi + c(5,3).*eta  + c(6,3)',...
            'c(1,4).*csi.^2 + c(2,4).*eta.^2 + c(3,4).*csi.*eta + c(4,4).*csi + c(5,4).*eta  + c(6,4)',...
            'c(1,5).*csi.^2 + c(2,5).*eta.^2 + c(3,5).*csi.*eta + c(4,5).*csi + c(5,5).*eta  + c(6,5)',...
            'c(1,6).*csi.^2 + c(2,6).*eta.^2 + c(3,6).*csi.*eta + c(4,6).*csi + c(5,6).*eta  + c(6,6)'},...
            'Gbasis_1',{'c(1,1).*2.*csi + c(3,1).*eta + c(4,1)',...
            'c(1,2).*2.*csi + c(3,2).*eta + c(4,2)',...
            'c(1,3).*2.*csi + c(3,3).*eta + c(4,3)',...
            'c(1,4).*2.*csi + c(3,4).*eta + c(4,4)',...
            'c(1,5).*2.*csi + c(3,5).*eta + c(4,5)',...
            'c(1,6).*2.*csi + c(3,6).*eta + c(4,6)'},...
            'Gbasis_2',{'2.*c(2,1).*eta + c(3,1).*csi + c(5,1)',...
            '2.*c(2,2).*eta + c(3,2).*csi + c(5,2)',...
            '2.*c(2,3).*eta + c(3,3).*csi + c(5,3)',...
            '2.*c(2,4).*eta + c(3,4).*csi + c(5,4)',...
            '2.*c(2,5).*eta + c(3,5).*csi + c(5,5)',...
            '2.*c(2,6).*eta + c(3,6).*csi + c(5,6)'});

    case 'P3'
        nln=10;
        [c]= matrix_coeff_P3(nln);
        basis=struct('num',nln,...
            'n_edge',10,...
            'coeff',c,...
            'fbasis',{'c(1,1) .*csi.^3 + c(2,1) .*eta.^3 + c(3,1) .*csi.^2.*eta + c(4,1) .*csi.*eta.^2 + c(5,1) .*csi.^2  + c(6,1) .*eta.^2 + c(7,1) .*csi.*eta + c(8,1) .*csi + c(9,1) .*eta + c(10,1)',...
            'c(1,2) .*csi.^3 + c(2,2) .*eta.^3 + c(3,2) .*csi.^2.*eta + c(4,2) .*csi.*eta.^2 + c(5,2) .*csi.^2  + c(6,2) .*eta.^2 + c(7,2) .*csi.*eta + c(8,2) .*csi + c(9,2) .*eta + c(10,2)',...
            'c(1,3) .*csi.^3 + c(2,3) .*eta.^3 + c(3,3) .*csi.^2.*eta + c(4,3) .*csi.*eta.^2 + c(5,3) .*csi.^2  + c(6,3) .*eta.^2 + c(7,3) .*csi.*eta + c(8,3) .*csi + c(9,3) .*eta + c(10,3)',...
            'c(1,4) .*csi.^3 + c(2,4) .*eta.^3 + c(3,4) .*csi.^2.*eta + c(4,4) .*csi.*eta.^2 + c(5,4) .*csi.^2  + c(6,4) .*eta.^2 + c(7,4) .*csi.*eta + c(8,4) .*csi + c(9,4) .*eta + c(10,4)',...
            'c(1,5) .*csi.^3 + c(2,5) .*eta.^3 + c(3,5) .*csi.^2.*eta + c(4,5) .*csi.*eta.^2 + c(5,5) .*csi.^2  + c(6,5) .*eta.^2 + c(7,5) .*csi.*eta + c(8,5) .*csi + c(9,5) .*eta + c(10,5)',...
            'c(1,6) .*csi.^3 + c(2,6) .*eta.^3 + c(3,6) .*csi.^2.*eta + c(4,6) .*csi.*eta.^2 + c(5,6) .*csi.^2  + c(6,6) .*eta.^2 + c(7,6) .*csi.*eta + c(8,6) .*csi + c(9,6) .*eta + c(10,6)',...
            'c(1,7) .*csi.^3 + c(2,7) .*eta.^3 + c(3,7) .*csi.^2.*eta + c(4,7) .*csi.*eta.^2 + c(5,7) .*csi.^2  + c(6,7) .*eta.^2 + c(7,7) .*csi.*eta + c(8,7) .*csi + c(9,7) .*eta + c(10,7)',...
            'c(1,8) .*csi.^3 + c(2,8) .*eta.^3 + c(3,8) .*csi.^2.*eta + c(4,8) .*csi.*eta.^2 + c(5,8) .*csi.^2  + c(6,8) .*eta.^2 + c(7,8) .*csi.*eta + c(8,8) .*csi + c(9,8) .*eta + c(10,8)',...
            'c(1,9) .*csi.^3 + c(2,9) .*eta.^3 + c(3,9) .*csi.^2.*eta + c(4,9) .*csi.*eta.^2 + c(5,9) .*csi.^2  + c(6,9) .*eta.^2 + c(7,9) .*csi.*eta + c(8,9) .*csi + c(9,9) .*eta + c(10,9)',...
            'c(1,10).*csi.^3 + c(2,10).*eta.^3 + c(3,10).*csi.^2.*eta + c(4,10).*csi.*eta.^2 + c(5,10).*csi.^2  + c(6,10).*eta.^2 + c(7,10).*csi.*eta + c(8,10).*csi + c(9,10).*eta + c(10,10)'},...
            'Gbasis_1',{ 'c(1,1) .*3.*csi.^2 + c(3,1) .*2.*csi.*eta + c(4,1) .*eta.^2 + c(5,1) .*2.*csi  + c(7,1) .*eta + c(8,1)',...
            'c(1,2) .*3.*csi.^2 + c(3,2) .*2.*csi.*eta + c(4,2) .*eta.^2 + c(5,2) .*2.*csi  + c(7,2) .*eta + c(8,2)',...
            'c(1,3) .*3.*csi.^2 + c(3,3) .*2.*csi.*eta + c(4,3) .*eta.^2 + c(5,3) .*2.*csi  + c(7,3) .*eta + c(8,3)',...
            'c(1,4) .*3.*csi.^2 + c(3,4) .*2.*csi.*eta + c(4,4) .*eta.^2 + c(5,4) .*2.*csi  + c(7,4) .*eta + c(8,4)',...
            'c(1,5) .*3.*csi.^2 + c(3,5) .*2.*csi.*eta + c(4,5) .*eta.^2 + c(5,5) .*2.*csi  + c(7,5) .*eta + c(8,5)',...
            'c(1,6) .*3.*csi.^2 + c(3,6) .*2.*csi.*eta + c(4,6) .*eta.^2 + c(5,6) .*2.*csi  + c(7,6) .*eta + c(8,6)',...
            'c(1,7) .*3.*csi.^2 + c(3,7) .*2.*csi.*eta + c(4,7) .*eta.^2 + c(5,7) .*2.*csi  + c(7,7) .*eta + c(8,7)',...
            'c(1,8) .*3.*csi.^2 + c(3,8) .*2.*csi.*eta + c(4,8) .*eta.^2 + c(5,8) .*2.*csi  + c(7,8) .*eta + c(8,8)',...
            'c(1,9) .*3.*csi.^2 + c(3,9) .*2.*csi.*eta + c(4,9) .*eta.^2 + c(5,9) .*2.*csi  + c(7,9) .*eta + c(8,9)',...
            'c(1,10).*3.*csi.^2 + c(3,10).*2.*csi.*eta + c(4,10).*eta.^2 + c(5,10).*2.*csi  + c(7,10).*eta + c(8,10)'},...
            'Gbasis_2',{ 'c(2,1) .*3.*eta.^2 + c(3,1) .*csi.^2  + c(4,1) .*csi.*2.*eta + c(6,1) .*2.*eta + c(7,1) .*csi + c(9,1)',...
            'c(2,2) .*3.*eta.^2 + c(3,2) .*csi.^2  + c(4,2) .*csi.*2.*eta + c(6,2) .*2.*eta + c(7,2) .*csi + c(9,2)',...
            'c(2,3) .*3.*eta.^2 + c(3,3) .*csi.^2  + c(4,3) .*csi.*2.*eta + c(6,3) .*2.*eta + c(7,3) .*csi + c(9,3)',...
            'c(2,4) .*3.*eta.^2 + c(3,4) .*csi.^2  + c(4,4) .*csi.*2.*eta + c(6,4) .*2.*eta + c(7,4) .*csi + c(9,4)',...
            'c(2,5) .*3.*eta.^2 + c(3,5) .*csi.^2  + c(4,5) .*csi.*2.*eta + c(6,5) .*2.*eta + c(7,5) .*csi + c(9,5)',...
            'c(2,6) .*3.*eta.^2 + c(3,6) .*csi.^2  + c(4,6) .*csi.*2.*eta + c(6,6) .*2.*eta + c(7,6) .*csi + c(9,6)',...
            'c(2,7) .*3.*eta.^2 + c(3,7) .*csi.^2  + c(4,7) .*csi.*2.*eta + c(6,7) .*2.*eta + c(7,7) .*csi + c(9,7)',...
            'c(2,8) .*3.*eta.^2 + c(3,8) .*csi.^2  + c(4,8) .*csi.*2.*eta + c(6,8) .*2.*eta + c(7,8) .*csi + c(9,8)',...
            'c(2,9) .*3.*eta.^2 + c(3,9) .*csi.^2  + c(4,9) .*csi.*2.*eta + c(6,9) .*2.*eta + c(7,9) .*csi + c(9,9)',...
            'c(2,10).*3.*eta.^2 + c(3,10).*csi.^2  + c(4,10).*csi.*2.*eta + c(6,10).*2.*eta + c(7,10).*csi + c(9,10)'});

    case 'P4'
        nln=15;
        [c]= matrix_coeff_P4(nln);
        basis=struct('num',nln,...
            'n_edge',3,...
            'coeff',c,...
            'fbasis',{'c(1,1)  .*csi.^4 + c(2,1)  .*eta.^4 + c(3,1)  .*csi.^3.*eta + c(4,1)  .*csi.^2.*eta.^2  + c(5,1)  .* csi.*eta.^3 + c(6,1)  .*csi.^3 + c(7,1)  .*eta.^3 + c(8,1)  .*csi.^2.*eta + c(9,1)  .*csi.*eta.^2 + c(10,1) .*csi.^2 + c(11,1) .*eta.^2 + c(12,1) .*csi.*eta + c(13,1) .*csi + c(14,1) .*eta + c(15,1)',...
            'c(1,2)  .*csi.^4 + c(2,2)  .*eta.^4 + c(3,2)  .*csi.^3.*eta + c(4,2)  .*csi.^2.*eta.^2  + c(5,2)  .* csi.*eta.^3 + c(6,2)  .*csi.^3 + c(7,2)  .*eta.^3 + c(8,2)  .*csi.^2.*eta + c(9,2)  .*csi.*eta.^2 + c(10,2) .*csi.^2 + c(11,2) .*eta.^2 + c(12,2) .*csi.*eta + c(13,2) .*csi + c(14,2) .*eta + c(15,2)',...
            'c(1,3)  .*csi.^4 + c(2,3)  .*eta.^4 + c(3,3)  .*csi.^3.*eta + c(4,3)  .*csi.^2.*eta.^2  + c(5,3)  .* csi.*eta.^3 + c(6,3)  .*csi.^3 + c(7,3)  .*eta.^3 + c(8,3)  .*csi.^2.*eta + c(9,3)  .*csi.*eta.^2 + c(10,3) .*csi.^2 + c(11,3) .*eta.^2 + c(12,3) .*csi.*eta + c(13,3) .*csi + c(14,3) .*eta + c(15,3)',...
            'c(1,4)  .*csi.^4 + c(2,4)  .*eta.^4 + c(3,4)  .*csi.^3.*eta + c(4,4)  .*csi.^2.*eta.^2  + c(5,4)  .* csi.*eta.^3 + c(6,4)  .*csi.^3 + c(7,4)  .*eta.^3 + c(8,4)  .*csi.^2.*eta + c(9,4)  .*csi.*eta.^2 + c(10,4) .*csi.^2 + c(11,4) .*eta.^2 + c(12,4) .*csi.*eta + c(13,4) .*csi + c(14,4) .*eta + c(15,4)',...
            'c(1,5)  .*csi.^4 + c(2,5)  .*eta.^4 + c(3,5)  .*csi.^3.*eta + c(4,5)  .*csi.^2.*eta.^2  + c(5,5)  .* csi.*eta.^3 + c(6,5)  .*csi.^3 + c(7,5)  .*eta.^3 + c(8,5)  .*csi.^2.*eta + c(9,5)  .*csi.*eta.^2 + c(10,5) .*csi.^2 + c(11,5) .*eta.^2 + c(12,5) .*csi.*eta + c(13,5) .*csi + c(14,5) .*eta + c(15,5)',...
            'c(1,6)  .*csi.^4 + c(2,6)  .*eta.^4 + c(3,6)  .*csi.^3.*eta + c(4,6)  .*csi.^2.*eta.^2  + c(5,6)  .* csi.*eta.^3 + c(6,6)  .*csi.^3 + c(7,6)  .*eta.^3 + c(8,6)  .*csi.^2.*eta + c(9,6)  .*csi.*eta.^2 + c(10,6) .*csi.^2 + c(11,6) .*eta.^2 + c(12,6) .*csi.*eta + c(13,6) .*csi + c(14,6) .*eta + c(15,6)',...
            'c(1,7)  .*csi.^4 + c(2,7)  .*eta.^4 + c(3,7)  .*csi.^3.*eta + c(4,7)  .*csi.^2.*eta.^2  + c(5,7)  .* csi.*eta.^3 + c(6,7)  .*csi.^3 + c(7,7)  .*eta.^3 + c(8,7)  .*csi.^2.*eta + c(9,7)  .*csi.*eta.^2 + c(10,7) .*csi.^2 + c(11,7) .*eta.^2 + c(12,7) .*csi.*eta + c(13,7) .*csi + c(14,7) .*eta + c(15,7)',...
            'c(1,8)  .*csi.^4 + c(2,8)  .*eta.^4 + c(3,8)  .*csi.^3.*eta + c(4,8)  .*csi.^2.*eta.^2  + c(5,8)  .* csi.*eta.^3 + c(6,8)  .*csi.^3 + c(7,8)  .*eta.^3 + c(8,8)  .*csi.^2.*eta + c(9,8)  .*csi.*eta.^2 + c(10,8) .*csi.^2 + c(11,8) .*eta.^2 + c(12,8) .*csi.*eta + c(13,8) .*csi + c(14,8) .*eta + c(15,8)',...
            'c(1,9)  .*csi.^4 + c(2,9)  .*eta.^4 + c(3,9)  .*csi.^3.*eta + c(4,9)  .*csi.^2.*eta.^2  + c(5,9)  .* csi.*eta.^3 + c(6,9)  .*csi.^3 + c(7,9)  .*eta.^3 + c(8,9)  .*csi.^2.*eta + c(9,9)  .*csi.*eta.^2 + c(10,9) .*csi.^2 + c(11,9) .*eta.^2 + c(12,9) .*csi.*eta + c(13,9) .*csi + c(14,9) .*eta + c(15,9)',...
            'c(1,10) .*csi.^4 + c(2,10) .*eta.^4 + c(3,10) .*csi.^3.*eta + c(4,10) .*csi.^2.*eta.^2  + c(5,10) .* csi.*eta.^3 + c(6,10) .*csi.^3 + c(7,10) .*eta.^3 + c(8,10) .*csi.^2.*eta + c(9,10) .*csi.*eta.^2 + c(10,10).*csi.^2 + c(11,10).*eta.^2 + c(12,10).*csi.*eta + c(13,10).*csi + c(14,10).*eta + c(15,10)',...
            'c(1,11) .*csi.^4 + c(2,11) .*eta.^4 + c(3,11) .*csi.^3.*eta + c(4,11) .*csi.^2.*eta.^2  + c(5,11) .* csi.*eta.^3 + c(6,11) .*csi.^3 + c(7,11) .*eta.^3 + c(8,11) .*csi.^2.*eta + c(9,11) .*csi.*eta.^2 + c(10,11).*csi.^2 + c(11,11).*eta.^2 + c(12,11).*csi.*eta + c(13,11).*csi + c(14,11).*eta + c(15,11)',...
            'c(1,12) .*csi.^4 + c(2,12) .*eta.^4 + c(3,12) .*csi.^3.*eta + c(4,12) .*csi.^2.*eta.^2  + c(5,12) .* csi.*eta.^3 + c(6,12) .*csi.^3 + c(7,12) .*eta.^3 + c(8,12) .*csi.^2.*eta + c(9,12) .*csi.*eta.^2 + c(10,12).*csi.^2 + c(11,12).*eta.^2 + c(12,12).*csi.*eta + c(13,12).*csi + c(14,12).*eta + c(15,12)',...
            'c(1,13) .*csi.^4 + c(2,13) .*eta.^4 + c(3,13) .*csi.^3.*eta + c(4,13) .*csi.^2.*eta.^2  + c(5,13) .* csi.*eta.^3 + c(6,13) .*csi.^3 + c(7,13) .*eta.^3 + c(8,13) .*csi.^2.*eta + c(9,13) .*csi.*eta.^2 + c(10,13).*csi.^2 + c(11,13).*eta.^2 + c(12,13).*csi.*eta + c(13,13).*csi + c(14,13).*eta + c(15,13)',...
            'c(1,14) .*csi.^4 + c(2,14) .*eta.^4 + c(3,14) .*csi.^3.*eta + c(4,14) .*csi.^2.*eta.^2  + c(5,14) .* csi.*eta.^3 + c(6,14) .*csi.^3 + c(7,14) .*eta.^3 + c(8,14) .*csi.^2.*eta + c(9,14) .*csi.*eta.^2 + c(10,14).*csi.^2 + c(11,14).*eta.^2 + c(12,14).*csi.*eta + c(13,14).*csi + c(14,14).*eta + c(15,14)',...
            'c(1,15) .*csi.^4 + c(2,15) .*eta.^4 + c(3,15) .*csi.^3.*eta + c(4,15) .*csi.^2.*eta.^2  + c(5,15) .* csi.*eta.^3 + c(6,15) .*csi.^3 + c(7,15) .*eta.^3 + c(8,15) .*csi.^2.*eta + c(9,15) .*csi.*eta.^2 + c(10,15).*csi.^2 + c(11,15).*eta.^2 + c(12,15).*csi.*eta + c(13,15).*csi + c(14,15).*eta + c(15,15)'},...
            'Gbasis_1',{'c(1,1) .*4.*csi.^3 + 0.*c(2,1)  .*eta.^4 + c(3,1) .*3.*csi.^2.*eta + c(4,1) .*2.*csi.*eta.^2  + c(5,1)  .*eta.^3 + c(6,1) .*3.*csi.^2 + c(7,1)  .*0.*eta.^3 + c(8,1)  .*2.*csi.*eta + c(9,1)  .*eta.^2 + c(10,1) .*2.*csi + c(11,1) .*0.*eta.^2 + c(12,1) .*eta + c(13,1) .*csi.^0 + c(14,1) .*0.*eta + 0.*c(15,1)',...
            'c(1,2)  .*4.*csi.^3 + 0.*c(2,2)  .*eta.^4 + c(3,2) .*3.*csi.^2.*eta + c(4,2) .*2.*csi.*eta.^2  + c(5,2)  .*eta.^3 + c(6,2) .*3.*csi.^2 + c(7,2)  .*0.*eta.^3 + c(8,2)  .*2.*csi.*eta + c(9,2)  .*eta.^2 + c(10,2) .*2.*csi + c(11,2) .*0.*eta.^2 + c(12,2) .*eta + c(13,2) .*csi.^0 + c(14,2) .*0.*eta + 0.*c(15,2)',...
            'c(1,3)  .*4.*csi.^3 + 0.*c(2,3)  .*eta.^4 + c(3,3) .*3.*csi.^2.*eta + c(4,3) .*2.*csi.*eta.^2  + c(5,3)  .*eta.^3 + c(6,3) .*3.*csi.^2 + c(7,3)  .*0.*eta.^3 + c(8,3)  .*2.*csi.*eta + c(9,3)  .*eta.^2 + c(10,3) .*2.*csi + c(11,3) .*0.*eta.^2 + c(12,3) .*eta + c(13,3) .*csi.^0 + c(14,3) .*0.*eta + 0.*c(15,3)',...
            'c(1,4)  .*4.*csi.^3 + 0.*c(2,4)  .*eta.^4 + c(3,4) .*3.*csi.^2.*eta + c(4,4) .*2.*csi.*eta.^2  + c(5,4)  .*eta.^3 + c(6,4) .*3.*csi.^2 + c(7,4)  .*0.*eta.^3 + c(8,4)  .*2.*csi.*eta + c(9,4)  .*eta.^2 + c(10,4) .*2.*csi + c(11,4) .*0.*eta.^2 + c(12,4) .*eta + c(13,4) .*csi.^0 + c(14,4) .*0.*eta + 0.*c(15,4)',...
            'c(1,5)  .*4.*csi.^3 + 0.*c(2,5)  .*eta.^4 + c(3,5) .*3.*csi.^2.*eta + c(4,5) .*2.*csi.*eta.^2  + c(5,5)  .*eta.^3 + c(6,5) .*3.*csi.^2 + c(7,5)  .*0.*eta.^3 + c(8,5)  .*2.*csi.*eta + c(9,5)  .*eta.^2 + c(10,5) .*2.*csi + c(11,5) .*0.*eta.^2 + c(12,5) .*eta + c(13,5) .*csi.^0 + c(14,5) .*0.*eta + 0.*c(15,5)',...
            'c(1,6)  .*4.*csi.^3 + 0.*c(2,6)  .*eta.^4 + c(3,6) .*3.*csi.^2.*eta + c(4,6) .*2.*csi.*eta.^2  + c(5,6)  .*eta.^3 + c(6,6) .*3.*csi.^2 + c(7,6)  .*0.*eta.^3 + c(8,6)  .*2.*csi.*eta + c(9,6)  .*eta.^2 + c(10,6) .*2.*csi + c(11,6) .*0.*eta.^2 + c(12,6) .*eta + c(13,6) .*csi.^0 + c(14,6) .*0.*eta + 0.*c(15,6)',...
            'c(1,7)  .*4.*csi.^3 + 0.*c(2,7)  .*eta.^4 + c(3,7) .*3.*csi.^2.*eta + c(4,7) .*2.*csi.*eta.^2  + c(5,7)  .*eta.^3 + c(6,7) .*3.*csi.^2 + c(7,7)  .*0.*eta.^3 + c(8,7)  .*2.*csi.*eta + c(9,7)  .*eta.^2 + c(10,7) .*2.*csi + c(11,7) .*0.*eta.^2 + c(12,7) .*eta + c(13,7) .*csi.^0 + c(14,7) .*0.*eta + 0.*c(15,7)',...
            'c(1,8)  .*4.*csi.^3 + 0.*c(2,8)  .*eta.^4 + c(3,8) .*3.*csi.^2.*eta + c(4,8) .*2.*csi.*eta.^2  + c(5,8)  .*eta.^3 + c(6,8) .*3.*csi.^2 + c(7,8)  .*0.*eta.^3 + c(8,8)  .*2.*csi.*eta + c(9,8)  .*eta.^2 + c(10,8) .*2.*csi + c(11,8) .*0.*eta.^2 + c(12,8) .*eta + c(13,8) .*csi.^0 + c(14,8) .*0.*eta + 0.*c(15,8)',...
            'c(1,9)  .*4.*csi.^3 + 0.*c(2,9)  .*eta.^4 + c(3,9) .*3.*csi.^2.*eta + c(4,9) .*2.*csi.*eta.^2  + c(5,9)  .*eta.^3 + c(6,9) .*3.*csi.^2 + c(7,9)  .*0.*eta.^3 + c(8,9)  .*2.*csi.*eta + c(9,9)  .*eta.^2 + c(10,9) .*2.*csi + c(11,9) .*0.*eta.^2 + c(12,9) .*eta + c(13,9) .*csi.^0 + c(14,9) .*0.*eta + 0.*c(15,9)',...
            'c(1,10) .*4.*csi.^3 + 0.*c(2,10) .*eta.^4 + c(3,10).*3.*csi.^2.*eta + c(4,10).*2.*csi.*eta.^2  + c(5,10) .*eta.^3 + c(6,10).*3.*csi.^2 + c(7,10) .*0.*eta.^3 + c(8,10) .*2.*csi.*eta + c(9,10) .*eta.^2 + c(10,10).*2.*csi + c(11,10).*0.*eta.^2 + c(12,10).*eta + c(13,10).*csi.^0 + c(14,10).*0.*eta + 0.*c(15,10)',...
            'c(1,11) .*4.*csi.^3 + 0.*c(2,11) .*eta.^4 + c(3,11).*3.*csi.^2.*eta + c(4,11).*2.*csi.*eta.^2  + c(5,11) .*eta.^3 + c(6,11).*3.*csi.^2 + c(7,11) .*0.*eta.^3 + c(8,11) .*2.*csi.*eta + c(9,11) .*eta.^2 + c(10,11).*2.*csi + c(11,11).*0.*eta.^2 + c(12,11).*eta + c(13,11).*csi.^0 + c(14,11).*0.*eta + 0.*c(15,11)',...
            'c(1,12) .*4.*csi.^3 + 0.*c(2,12) .*eta.^4 + c(3,12).*3.*csi.^2.*eta + c(4,12).*2.*csi.*eta.^2  + c(5,12) .*eta.^3 + c(6,12).*3.*csi.^2 + c(7,12) .*0.*eta.^3 + c(8,12) .*2.*csi.*eta + c(9,12) .*eta.^2 + c(10,12).*2.*csi + c(11,12).*0.*eta.^2 + c(12,12).*eta + c(13,12).*csi.^0 + c(14,12).*0.*eta + 0.*c(15,12)',...
            'c(1,13) .*4.*csi.^3 + 0.*c(2,13) .*eta.^4 + c(3,13).*3.*csi.^2.*eta + c(4,13).*2.*csi.*eta.^2  + c(5,13) .*eta.^3 + c(6,13).*3.*csi.^2 + c(7,13) .*0.*eta.^3 + c(8,13) .*2.*csi.*eta + c(9,13) .*eta.^2 + c(10,13).*2.*csi + c(11,13).*0.*eta.^2 + c(12,13).*eta + c(13,13).*csi.^0 + c(14,13).*0.*eta + 0.*c(15,13)',...
            'c(1,14) .*4.*csi.^3 + 0.*c(2,14) .*eta.^4 + c(3,14).*3.*csi.^2.*eta + c(4,14).*2.*csi.*eta.^2  + c(5,14) .*eta.^3 + c(6,14).*3.*csi.^2 + c(7,14) .*0.*eta.^3 + c(8,14) .*2.*csi.*eta + c(9,14) .*eta.^2 + c(10,14).*2.*csi + c(11,14).*0.*eta.^2 + c(12,14).*eta + c(13,14).*csi.^0 + c(14,14).*0.*eta + 0.*c(15,14)',...
            'c(1,15) .*4.*csi.^3 + 0.*c(2,15) .*eta.^4 + c(3,15).*3.*csi.^2.*eta + c(4,15).*2.*csi.*eta.^2  + c(5,15) .*eta.^3 + c(6,15).*3.*csi.^2 + c(7,15) .*0.*eta.^3 + c(8,15) .*2.*csi.*eta + c(9,15) .*eta.^2 + c(10,15).*2.*csi + c(11,15).*0.*eta.^2 + c(12,15).*eta + c(13,15).*csi.^0 + c(14,15).*0.*eta + 0.*c(15,15)'},...
            'Gbasis_2',{'c(1,1)  .*0.*csi.^4 + c(2,1)  .*4.*eta.^3 + c(3,1)  .*csi.^3. + c(4,1)  .*2.*csi.^2.*eta  + c(5,1)  .* 3.*csi.*eta.^2 + c(6,1)  .*0.*csi.^3 + c(7,1)  .*3.*eta.^2 + c(8,1)  .*csi.^2 + c(9,1)  .*2.*csi.*eta + c(10,1) .*0.*csi.^2 + c(11,1) .*2.*eta + c(12,1) .*csi + c(13,1) .*0.*csi + c(14,1) .*eta.^0 + 0.*c(15,1)',...
            'c(1,2)  .*0.*csi.^4 + c(2,2)  .*4.*eta.^3 + c(3,2)  .*csi.^3. + c(4,2)  .*2.*csi.^2.*eta  + c(5,2)  .* 3.*csi.*eta.^2 + c(6,2)  .*0.*csi.^3 + c(7,2)  .*3.*eta.^2 + c(8,2)  .*csi.^2 + c(9,2)  .*2.*csi.*eta + c(10,2) .*0.*csi.^2 + c(11,2) .*2.*eta + c(12,2) .*csi + c(13,2) .*0.*csi + c(14,2) .*eta.^0 + 0.*c(15,2)',...
            'c(1,3)  .*0.*csi.^4 + c(2,3)  .*4.*eta.^3 + c(3,3)  .*csi.^3. + c(4,3)  .*2.*csi.^2.*eta  + c(5,3)  .* 3.*csi.*eta.^2 + c(6,3)  .*0.*csi.^3 + c(7,3)  .*3.*eta.^2 + c(8,3)  .*csi.^2 + c(9,3)  .*2.*csi.*eta + c(10,3) .*0.*csi.^2 + c(11,3) .*2.*eta + c(12,3) .*csi + c(13,3) .*0.*csi + c(14,3) .*eta.^0 + 0.*c(15,3)',...
            'c(1,4)  .*0.*csi.^4 + c(2,4)  .*4.*eta.^3 + c(3,4)  .*csi.^3. + c(4,4)  .*2.*csi.^2.*eta  + c(5,4)  .* 3.*csi.*eta.^2 + c(6,4)  .*0.*csi.^3 + c(7,4)  .*3.*eta.^2 + c(8,4)  .*csi.^2 + c(9,4)  .*2.*csi.*eta + c(10,4) .*0.*csi.^2 + c(11,4) .*2.*eta + c(12,4) .*csi + c(13,4) .*0.*csi + c(14,4) .*eta.^0 + 0.*c(15,4)',...
            'c(1,5)  .*0.*csi.^4 + c(2,5)  .*4.*eta.^3 + c(3,5)  .*csi.^3. + c(4,5)  .*2.*csi.^2.*eta  + c(5,5)  .* 3.*csi.*eta.^2 + c(6,5)  .*0.*csi.^3 + c(7,5)  .*3.*eta.^2 + c(8,5)  .*csi.^2 + c(9,5)  .*2.*csi.*eta + c(10,5) .*0.*csi.^2 + c(11,5) .*2.*eta + c(12,5) .*csi + c(13,5) .*0.*csi + c(14,5) .*eta.^0 + 0.*c(15,5)',...
            'c(1,6)  .*0.*csi.^4 + c(2,6)  .*4.*eta.^3 + c(3,6)  .*csi.^3. + c(4,6)  .*2.*csi.^2.*eta  + c(5,6)  .* 3.*csi.*eta.^2 + c(6,6)  .*0.*csi.^3 + c(7,6)  .*3.*eta.^2 + c(8,6)  .*csi.^2 + c(9,6)  .*2.*csi.*eta + c(10,6) .*0.*csi.^2 + c(11,6) .*2.*eta + c(12,6) .*csi + c(13,6) .*0.*csi + c(14,6) .*eta.^0 + 0.*c(15,6)',...
            'c(1,7)  .*0.*csi.^4 + c(2,7)  .*4.*eta.^3 + c(3,7)  .*csi.^3. + c(4,7)  .*2.*csi.^2.*eta  + c(5,7)  .* 3.*csi.*eta.^2 + c(6,7)  .*0.*csi.^3 + c(7,7)  .*3.*eta.^2 + c(8,7)  .*csi.^2 + c(9,7)  .*2.*csi.*eta + c(10,7) .*0.*csi.^2 + c(11,7) .*2.*eta + c(12,7) .*csi + c(13,7) .*0.*csi + c(14,7) .*eta.^0 + 0.*c(15,7)',...
            'c(1,8)  .*0.*csi.^4 + c(2,8)  .*4.*eta.^3 + c(3,8)  .*csi.^3. + c(4,8)  .*2.*csi.^2.*eta  + c(5,8)  .* 3.*csi.*eta.^2 + c(6,8)  .*0.*csi.^3 + c(7,8)  .*3.*eta.^2 + c(8,8)  .*csi.^2 + c(9,8)  .*2.*csi.*eta + c(10,8) .*0.*csi.^2 + c(11,8) .*2.*eta + c(12,8) .*csi + c(13,8) .*0.*csi + c(14,8) .*eta.^0 + 0.*c(15,8)',...
            'c(1,9)  .*0.*csi.^4 + c(2,9)  .*4.*eta.^3 + c(3,9)  .*csi.^3. + c(4,9)  .*2.*csi.^2.*eta  + c(5,9)  .* 3.*csi.*eta.^2 + c(6,9)  .*0.*csi.^3 + c(7,9)  .*3.*eta.^2 + c(8,9)  .*csi.^2 + c(9,9)  .*2.*csi.*eta + c(10,9) .*0.*csi.^2 + c(11,9) .*2.*eta + c(12,9) .*csi + c(13,9) .*0.*csi + c(14,9) .*eta.^0 + 0.*c(15,9)',...
            'c(1,10) .*0.*csi.^4 + c(2,10) .*4.*eta.^3 + c(3,10) .*csi.^3. + c(4,10) .*2.*csi.^2.*eta  + c(5,10) .* 3.*csi.*eta.^2 + c(6,10) .*0.*csi.^3 + c(7,10) .*3.*eta.^2 + c(8,10) .*csi.^2 + c(9,10) .*2.*csi.*eta + c(10,10).*0.*csi.^2 + c(11,10).*2.*eta + c(12,10).*csi + c(13,10).*0.*csi + c(14,10).*eta.^0 + 0.*c(15,10)',...
            'c(1,11) .*0.*csi.^4 + c(2,11) .*4.*eta.^3 + c(3,11) .*csi.^3. + c(4,11) .*2.*csi.^2.*eta  + c(5,11) .* 3.*csi.*eta.^2 + c(6,11) .*0.*csi.^3 + c(7,11) .*3.*eta.^2 + c(8,11) .*csi.^2 + c(9,11) .*2.*csi.*eta + c(10,11).*0.*csi.^2 + c(11,11).*2.*eta + c(12,11).*csi + c(13,11).*0.*csi + c(14,11).*eta.^0 + 0.*c(15,11)',...
            'c(1,12) .*0.*csi.^4 + c(2,12) .*4.*eta.^3 + c(3,12) .*csi.^3. + c(4,12) .*2.*csi.^2.*eta  + c(5,12) .* 3.*csi.*eta.^2 + c(6,12) .*0.*csi.^3 + c(7,12) .*3.*eta.^2 + c(8,12) .*csi.^2 + c(9,12) .*2.*csi.*eta + c(10,12).*0.*csi.^2 + c(11,12).*2.*eta + c(12,12).*csi + c(13,12).*0.*csi + c(14,12).*eta.^0 + 0.*c(15,12)',...
            'c(1,13) .*0.*csi.^4 + c(2,13) .*4.*eta.^3 + c(3,13) .*csi.^3. + c(4,13) .*2.*csi.^2.*eta  + c(5,13) .* 3.*csi.*eta.^2 + c(6,13) .*0.*csi.^3 + c(7,13) .*3.*eta.^2 + c(8,13) .*csi.^2 + c(9,13) .*2.*csi.*eta + c(10,13).*0.*csi.^2 + c(11,13).*2.*eta + c(12,13).*csi + c(13,13).*0.*csi + c(14,13).*eta.^0 + 0.*c(15,13)',...
            'c(1,14) .*0.*csi.^4 + c(2,14) .*4.*eta.^3 + c(3,14) .*csi.^3. + c(4,14) .*2.*csi.^2.*eta  + c(5,14) .* 3.*csi.*eta.^2 + c(6,14) .*0.*csi.^3 + c(7,14) .*3.*eta.^2 + c(8,14) .*csi.^2 + c(9,14) .*2.*csi.*eta + c(10,14).*0.*csi.^2 + c(11,14).*2.*eta + c(12,14).*csi + c(13,14).*0.*csi + c(14,14).*eta.^0 + 0.*c(15,14)',...
            'c(1,15) .*0.*csi.^4 + c(2,15) .*4.*eta.^3 + c(3,15) .*csi.^3. + c(4,15) .*2.*csi.^2.*eta  + c(5,15) .* 3.*csi.*eta.^2 + c(6,15) .*0.*csi.^3 + c(7,15) .*3.*eta.^2 + c(8,15) .*csi.^2 + c(9,15) .*2.*csi.*eta + c(10,15).*0.*csi.^2 + c(11,15).*2.*eta + c(12,15).*csi + c(13,15).*0.*csi + c(14,15).*eta.^0 + 0.*c(15,15)'});

    case 'Q1'
%         nln=4;
%         basis=struct('num',nln,...
%             'n_edge',4,...
%             'coeff', [],...
%             'fbasis',{'0.25.*(1-csi).*(1+eta)',...
%             '0.25.*(1-csi).*(1-eta)',...
%             '0.25.*(1+csi).*(1-eta)',...
%             '0.25.*(1+csi).*(1+eta)'},...
%             'Gbasis_1',{'-0.25.*(1+eta)',...
%             '-0.25.*(1-eta)',...
%             ' 0.25.*(1-eta)',...
%             ' 0.25.*(1+eta)'},...
%             'Gbasis_2',{' 0.25.*(1-csi)',...
%             '-0.25.*(1-csi)',...
%             '-0.25.*(1+csi)',...
%             ' 0.25.*(1+csi)'});


               nln=4;
               [c]= matrix_coeff_Q1(nln);
               basis=struct('num',nln,...
                   'n_edge',4,...
                   'coeff',c,...
                   'fbasis',{'c(1,1).*csi + c(2,1).*eta + c(3,1).*csi.*eta + c(4,1)',...
                   'c(1,2).*csi + c(2,2).*eta + c(3,2).*csi.*eta + c(4,2)',...
                   'c(1,3).*csi + c(2,3).*eta + c(3,3).*csi.*eta + c(4,3)',...
                   'c(1,4).*csi + c(2,4).*eta + c(3,4).*csi.*eta + c(4,4)'},...
                   'Gbasis_1',{'c(1,1).*1 + c(3,1).*eta + 0',...
                   'c(1,2).*1 + c(3,2).*eta + 0',...
                   'c(1,3).*1 + c(3,3).*eta + 0',...
                   'c(1,4).*1 + c(3,4).*eta + 0'},...
                   'Gbasis_2',{'0     .*csi + c(2,1).*1   + c(3,1).*csi',...
                   '0     .*csi + c(2,2).*1   + c(3,2).*csi',...
                   '0     .*csi + c(2,3).*1   + c(3,3).*csi',...
                   '0     .*csi + c(2,4).*1   + c(3,4).*csi'});
               
    % G_basis_1 = derivative with respect to csi
    % G_basis_2 = derivative with respect to eta
    case 'Q2'
        nln = 9;
        c = matrix_coeff_Q2(nln);
        basis=struct('num',nln,...
                   'n_edge',4,...
                   'coeff',c,...
                   'fbasis',{'c(1,1).*csi.^2 + c(2,1).*eta.^2 + c(3,1).*csi.^2.*eta.^2 + c(4,1).*csi.^2.*eta + c(5,1).*csi.*eta.^2 + c(6,1).*csi + c(7,1).*eta + c(8,1).*csi.*eta + c(9,1)',...
                   'c(1,2).*csi.^2 + c(2,2).*eta.^2 + c(3,2).*csi.^2.*eta.^2 + c(4,2).*csi.^2.*eta + c(5,2).*csi.*eta.^2 + c(6,2).*csi + c(7,2).*eta + c(8,2).*csi.*eta + c(9,2)',...
                   'c(1,3).*csi.^2 + c(2,3).*eta.^2 + c(3,3).*csi.^2.*eta.^2 + c(4,3).*csi.^2.*eta + c(5,3).*csi.*eta.^2 + c(6,3).*csi + c(7,3).*eta + c(8,3).*csi.*eta + c(9,3)',...
                   'c(1,4).*csi.^2 + c(2,4).*eta.^2 + c(3,4).*csi.^2.*eta.^2 + c(4,4).*csi.^2.*eta + c(5,4).*csi.*eta.^2 + c(6,4).*csi + c(7,4).*eta + c(8,4).*csi.*eta + c(9,4)',...
                   'c(1,5).*csi.^2 + c(2,5).*eta.^2 + c(3,5).*csi.^2.*eta.^2 + c(4,5).*csi.^2.*eta + c(5,5).*csi.*eta.^2 + c(6,5).*csi + c(7,5).*eta + c(8,5).*csi.*eta + c(9,5)',...
                   'c(1,6).*csi.^2 + c(2,6).*eta.^2 + c(3,6).*csi.^2.*eta.^2 + c(4,6).*csi.^2.*eta + c(5,6).*csi.*eta.^2 + c(6,6).*csi + c(7,6).*eta + c(8,6).*csi.*eta + c(9,6)',...
                   'c(1,7).*csi.^2 + c(2,7).*eta.^2 + c(3,7).*csi.^2.*eta.^2 + c(4,7).*csi.^2.*eta + c(5,7).*csi.*eta.^2 + c(6,7).*csi + c(7,7).*eta + c(8,7).*csi.*eta + c(9,7)',...
                   'c(1,8).*csi.^2 + c(2,8).*eta.^2 + c(3,8).*csi.^2.*eta.^2 + c(4,8).*csi.^2.*eta + c(5,8).*csi.*eta.^2 + c(6,8).*csi + c(7,8).*eta + c(8,8).*csi.*eta + c(9,8)',...
                   'c(1,9).*csi.^2 + c(2,9).*eta.^2 + c(3,9).*csi.^2.*eta.^2 + c(4,9).*csi.^2.*eta + c(5,9).*csi.*eta.^2 + c(6,9).*csi + c(7,9).*eta + c(8,9).*csi.*eta + c(9,9)'},...
                   'Gbasis_1',{'c(1,1).*2.*csi + c(3,1).*2.*csi.*eta.^2 + c(4,1).*2.*csi.*eta + c(5,1).*eta.^2 + c(6,1) + c(8,1).*eta + 0 ',...
                   'c(1,2).*2.*csi + c(3,2).*2.*csi.*eta.^2 + c(4,2).*2.*csi.*eta + c(5,2).*eta.^2 + c(6,2) + c(8,2).*eta + 0 ',...
                   'c(1,3).*2.*csi + c(3,3).*2.*csi.*eta.^2 + c(4,3).*2.*csi.*eta + c(5,3).*eta.^2 + c(6,3) + c(8,3).*eta + 0 ',...
                   'c(1,4).*2.*csi + c(3,4).*2.*csi.*eta.^2 + c(4,4).*2.*csi.*eta + c(5,4).*eta.^2 + c(6,4) + c(8,4).*eta + 0 ',...
                   'c(1,5).*2.*csi + c(3,5).*2.*csi.*eta.^2 + c(4,5).*2.*csi.*eta + c(5,5).*eta.^2 + c(6,5) + c(8,5).*eta + 0 ',...
                   'c(1,6).*2.*csi + c(3,6).*2.*csi.*eta.^2 + c(4,6).*2.*csi.*eta + c(5,6).*eta.^2 + c(6,6) + c(8,6).*eta + 0 ',...
                   'c(1,7).*2.*csi + c(3,7).*2.*csi.*eta.^2 + c(4,7).*2.*csi.*eta + c(5,7).*eta.^2 + c(6,7) + c(8,7).*eta + 0 ',...
                   'c(1,8).*2.*csi + c(3,8).*2.*csi.*eta.^2 + c(4,8).*2.*csi.*eta + c(5,8).*eta.^2 + c(6,8) + c(8,8).*eta + 0 ',...
                   'c(1,9).*2.*csi + c(3,9).*2.*csi.*eta.^2 + c(4,9).*2.*csi.*eta + c(5,9).*eta.^2 + c(6,9) + c(8,9).*eta + 0 '},...
                   'Gbasis_2',{'c(2,1).*2.*eta + c(3,1).*2.*eta.*csi.^2 + c(4,1).*csi.^2 + c(5,1).*2.*csi.*eta + c(7,1) + c(8,1).*csi',...
                   'c(2,2).*2.*eta + c(3,2).*2.*eta.*csi.^2 + c(4,2).*csi.^2 + c(5,2).*2.*csi.*eta + c(7,2) + c(8,2).*csi',...
                   'c(2,3).*2.*eta + c(3,3).*2.*eta.*csi.^2 + c(4,3).*csi.^2 + c(5,3).*2.*csi.*eta + c(7,3) + c(8,3).*csi',...
                   'c(2,4).*2.*eta + c(3,4).*2.*eta.*csi.^2 + c(4,4).*csi.^2 + c(5,4).*2.*csi.*eta + c(7,4) + c(8,4).*csi',...
                   'c(2,5).*2.*eta + c(3,5).*2.*eta.*csi.^2 + c(4,5).*csi.^2 + c(5,5).*2.*csi.*eta + c(7,5) + c(8,5).*csi',...
                   'c(2,6).*2.*eta + c(3,6).*2.*eta.*csi.^2 + c(4,6).*csi.^2 + c(5,6).*2.*csi.*eta + c(7,6) + c(8,6).*csi',...
                   'c(2,7).*2.*eta + c(3,7).*2.*eta.*csi.^2 + c(4,7).*csi.^2 + c(5,7).*2.*csi.*eta + c(7,7) + c(8,7).*csi',...
                   'c(2,8).*2.*eta + c(3,8).*2.*eta.*csi.^2 + c(4,8).*csi.^2 + c(5,8).*2.*csi.*eta + c(7,8) + c(8,8).*csi',...
                   'c(2,9).*2.*eta + c(3,9).*2.*eta.*csi.^2 + c(4,9).*csi.^2 + c(5,9).*2.*csi.*eta + c(7,9) + c(8,9).*csi'});
               
    case 'Q3'
        nln = 16;
        c = matrix_coeff_Q3(nln);
        basis=struct('num',nln,...
                   'n_edge',4,...
                   'coeff',c,...
                   'fbasis',{'c(1,1).*csi.^3 + c(2,1).*eta.^3 + c(3,1).*(csi.*eta).^3 + c(4,1).*csi.^3.*eta.^2 + c(5,1).*csi.^3.*eta + c(6,1).*csi.*eta.^3 + c(7,1).*csi.^2.*eta.^3 + c(8,1).*csi.^2 + c(9,1).*eta.^2 + c(10,1).*csi.^2.*eta.^2 + c(11,1).*csi.^2.*eta + c(12,1).*csi.*eta.^2 + c(13,1).*csi + c(14,1).*eta + c(15,1).*csi.*eta + c(16,1)',...
                   'c(1,2).*csi.^3 + c(2,2).*eta.^3 + c(3,2).*(csi.*eta).^3 + c(4,2).*csi.^3.*eta.^2 + c(5,2).*csi.^3.*eta + c(6,2).*csi.*eta.^3 + c(7,2).*csi.^2.*eta.^3 + c(8,2).*csi.^2 + c(9,2).*eta.^2 + c(10,2).*csi.^2.*eta.^2 + c(11,2).*csi.^2.*eta + c(12,2).*csi.*eta.^2 + c(13,2).*csi + c(14,2).*eta + c(15,2).*csi.*eta + c(16,2)',...
                   'c(1,3).*csi.^3 + c(2,3).*eta.^3 + c(3,3).*(csi.*eta).^3 + c(4,3).*csi.^3.*eta.^2 + c(5,3).*csi.^3.*eta + c(6,3).*csi.*eta.^3 + c(7,3).*csi.^2.*eta.^3 + c(8,3).*csi.^2 + c(9,3).*eta.^2 + c(10,3).*csi.^2.*eta.^2 + c(11,3).*csi.^2.*eta + c(12,3).*csi.*eta.^2 + c(13,3).*csi + c(14,3).*eta + c(15,3).*csi.*eta + c(16,3)',...
                   'c(1,4).*csi.^3 + c(2,4).*eta.^3 + c(3,4).*(csi.*eta).^3 + c(4,4).*csi.^3.*eta.^2 + c(5,4).*csi.^3.*eta + c(6,4).*csi.*eta.^3 + c(7,4).*csi.^2.*eta.^3 + c(8,4).*csi.^2 + c(9,4).*eta.^2 + c(10,4).*csi.^2.*eta.^2 + c(11,4).*csi.^2.*eta + c(12,4).*csi.*eta.^2 + c(13,4).*csi + c(14,4).*eta + c(15,4).*csi.*eta + c(16,4)',...
                   'c(1,5).*csi.^3 + c(2,5).*eta.^3 + c(3,5).*(csi.*eta).^3 + c(4,5).*csi.^3.*eta.^2 + c(5,5).*csi.^3.*eta + c(6,5).*csi.*eta.^3 + c(7,5).*csi.^2.*eta.^3 + c(8,5).*csi.^2 + c(9,5).*eta.^2 + c(10,5).*csi.^2.*eta.^2 + c(11,5).*csi.^2.*eta + c(12,5).*csi.*eta.^2 + c(13,5).*csi + c(14,5).*eta + c(15,5).*csi.*eta + c(16,5)',...
                   'c(1,6).*csi.^3 + c(2,6).*eta.^3 + c(3,6).*(csi.*eta).^3 + c(4,6).*csi.^3.*eta.^2 + c(5,6).*csi.^3.*eta + c(6,6).*csi.*eta.^3 + c(7,6).*csi.^2.*eta.^3 + c(8,6).*csi.^2 + c(9,6).*eta.^2 + c(10,6).*csi.^2.*eta.^2 + c(11,6).*csi.^2.*eta + c(12,6).*csi.*eta.^2 + c(13,6).*csi + c(14,6).*eta + c(15,6).*csi.*eta + c(16,6)',...
                   'c(1,7).*csi.^3 + c(2,7).*eta.^3 + c(3,7).*(csi.*eta).^3 + c(4,7).*csi.^3.*eta.^2 + c(5,7).*csi.^3.*eta + c(6,7).*csi.*eta.^3 + c(7,7).*csi.^2.*eta.^3 + c(8,7).*csi.^2 + c(9,7).*eta.^2 + c(10,7).*csi.^2.*eta.^2 + c(11,7).*csi.^2.*eta + c(12,7).*csi.*eta.^2 + c(13,7).*csi + c(14,7).*eta + c(15,7).*csi.*eta + c(16,7)',...
                   'c(1,8).*csi.^3 + c(2,8).*eta.^3 + c(3,8).*(csi.*eta).^3 + c(4,8).*csi.^3.*eta.^2 + c(5,8).*csi.^3.*eta + c(6,8).*csi.*eta.^3 + c(7,8).*csi.^2.*eta.^3 + c(8,8).*csi.^2 + c(9,8).*eta.^2 + c(10,8).*csi.^2.*eta.^2 + c(11,8).*csi.^2.*eta + c(12,8).*csi.*eta.^2 + c(13,8).*csi + c(14,8).*eta + c(15,8).*csi.*eta + c(16,8)',...
                   'c(1,9).*csi.^3 + c(2,9).*eta.^3 + c(3,9).*(csi.*eta).^3 + c(4,9).*csi.^3.*eta.^2 + c(5,9).*csi.^3.*eta + c(6,9).*csi.*eta.^3 + c(7,9).*csi.^2.*eta.^3 + c(8,9).*csi.^2 + c(9,9).*eta.^2 + c(10,9).*csi.^2.*eta.^2 + c(11,9).*csi.^2.*eta + c(12,9).*csi.*eta.^2 + c(13,9).*csi + c(14,9).*eta + c(15,9).*csi.*eta + c(16,9)',...
                   'c(1,10).*csi.^3 + c(2,10).*eta.^3 + c(3,10).*(csi.*eta).^3 + c(4,10).*csi.^3.*eta.^2 + c(5,10).*csi.^3.*eta + c(6,10).*csi.*eta.^3 + c(7,10).*csi.^2.*eta.^3 + c(8,10).*csi.^2 + c(9,10).*eta.^2 + c(10,10).*csi.^2.*eta.^2 + c(11,10).*csi.^2.*eta + c(12,10).*csi.*eta.^2 + c(13,10).*csi + c(14,10).*eta + c(15,10).*csi.*eta + c(16,10)',...
                   'c(1,11).*csi.^3 + c(2,11).*eta.^3 + c(3,11).*(csi.*eta).^3 + c(4,11).*csi.^3.*eta.^2 + c(5,11).*csi.^3.*eta + c(6,11).*csi.*eta.^3 + c(7,11).*csi.^2.*eta.^3 + c(8,11).*csi.^2 + c(9,11).*eta.^2 + c(10,11).*csi.^2.*eta.^2 + c(11,11).*csi.^2.*eta + c(12,11).*csi.*eta.^2 + c(13,11).*csi + c(14,11).*eta + c(15,11).*csi.*eta + c(16,11)',...
                   'c(1,12).*csi.^3 + c(2,12).*eta.^3 + c(3,12).*(csi.*eta).^3 + c(4,12).*csi.^3.*eta.^2 + c(5,12).*csi.^3.*eta + c(6,12).*csi.*eta.^3 + c(7,12).*csi.^2.*eta.^3 + c(8,12).*csi.^2 + c(9,12).*eta.^2 + c(10,12).*csi.^2.*eta.^2 + c(11,12).*csi.^2.*eta + c(12,12).*csi.*eta.^2 + c(13,12).*csi + c(14,12).*eta + c(15,12).*csi.*eta + c(16,12)',...
                   'c(1,13).*csi.^3 + c(2,13).*eta.^3 + c(3,13).*(csi.*eta).^3 + c(4,13).*csi.^3.*eta.^2 + c(5,13).*csi.^3.*eta + c(6,13).*csi.*eta.^3 + c(7,13).*csi.^2.*eta.^3 + c(8,13).*csi.^2 + c(9,13).*eta.^2 + c(10,13).*csi.^2.*eta.^2 + c(11,13).*csi.^2.*eta + c(12,13).*csi.*eta.^2 + c(13,13).*csi + c(14,13).*eta + c(15,13).*csi.*eta + c(16,13)',...
                   'c(1,14).*csi.^3 + c(2,14).*eta.^3 + c(3,14).*(csi.*eta).^3 + c(4,14).*csi.^3.*eta.^2 + c(5,14).*csi.^3.*eta + c(6,14).*csi.*eta.^3 + c(7,14).*csi.^2.*eta.^3 + c(8,14).*csi.^2 + c(9,14).*eta.^2 + c(10,14).*csi.^2.*eta.^2 + c(11,14).*csi.^2.*eta + c(12,14).*csi.*eta.^2 + c(13,14).*csi + c(14,14).*eta + c(15,14).*csi.*eta + c(16,14)',...
                   'c(1,15).*csi.^3 + c(2,15).*eta.^3 + c(3,15).*(csi.*eta).^3 + c(4,15).*csi.^3.*eta.^2 + c(5,15).*csi.^3.*eta + c(6,15).*csi.*eta.^3 + c(7,15).*csi.^2.*eta.^3 + c(8,15).*csi.^2 + c(9,15).*eta.^2 + c(10,15).*csi.^2.*eta.^2 + c(11,15).*csi.^2.*eta + c(12,15).*csi.*eta.^2 + c(13,15).*csi + c(14,15).*eta + c(15,15).*csi.*eta + c(16,15)',...
                   'c(1,16).*csi.^3 + c(2,16).*eta.^3 + c(3,16).*(csi.*eta).^3 + c(4,16).*csi.^3.*eta.^2 + c(5,16).*csi.^3.*eta + c(6,16).*csi.*eta.^3 + c(7,16).*csi.^2.*eta.^3 + c(8,16).*csi.^2 + c(9,16).*eta.^2 + c(10,16).*csi.^2.*eta.^2 + c(11,16).*csi.^2.*eta + c(12,16).*csi.*eta.^2 + c(13,16).*csi + c(14,16).*eta + c(15,16).*csi.*eta + c(16,16)'},...
                        'Gbasis_1',{'c(1,1).*3.*csi.^2 + c(3,1).*3.*csi.^2.*eta.^3 + c(4,1).*3.*csi.^2.*eta.^2 + c(5,1).*3.*csi.^2.*eta + c(6,1).*eta.^3 + c(7,1).*2.*csi.*eta.^3 + c(8,1).*2.*csi + c(10,1).*2.*csi.*eta.^2 + c(11,1).*2.*csi.*eta + c(12,1).*eta.^2 + c(13,1) + c(15,1).*eta + 0 ',...
                   'c(1,2).*3.*csi.^2 + c(3,2).*3.*csi.^2.*eta.^3 + c(4,2).*3.*csi.^2.*eta.^2 + c(5,2).*3.*csi.^2.*eta + c(6,2).*eta.^3 + c(7,2).*2.*csi.*eta.^3 + c(8,2).*2.*csi + c(10,2).*2.*csi.*eta.^2 + c(11,2).*2.*csi.*eta + c(12,2).*eta.^2 + c(13,2) + c(15,2).*eta + 0 ',...
                   'c(1,3).*3.*csi.^2 + c(3,3).*3.*csi.^2.*eta.^3 + c(4,3).*3.*csi.^2.*eta.^2 + c(5,3).*3.*csi.^2.*eta + c(6,3).*eta.^3 + c(7,3).*2.*csi.*eta.^3 + c(8,3).*2.*csi + c(10,3).*2.*csi.*eta.^2 + c(11,3).*2.*csi.*eta + c(12,3).*eta.^2 + c(13,3) + c(15,3).*eta + 0 ',...
                   'c(1,4).*3.*csi.^2 + c(3,4).*3.*csi.^2.*eta.^3 + c(4,4).*3.*csi.^2.*eta.^2 + c(5,4).*3.*csi.^2.*eta + c(6,4).*eta.^3 + c(7,4).*2.*csi.*eta.^3 + c(8,4).*2.*csi + c(10,4).*2.*csi.*eta.^2 + c(11,4).*2.*csi.*eta + c(12,4).*eta.^2 + c(13,4) + c(15,4).*eta + 0 ',...
                   'c(1,5).*3.*csi.^2 + c(3,5).*3.*csi.^2.*eta.^3 + c(4,5).*3.*csi.^2.*eta.^2 + c(5,5).*3.*csi.^2.*eta + c(6,5).*eta.^3 + c(7,5).*2.*csi.*eta.^3 + c(8,5).*2.*csi + c(10,5).*2.*csi.*eta.^2 + c(11,5).*2.*csi.*eta + c(12,5).*eta.^2 + c(13,5) + c(15,5).*eta + 0 ',...
                   'c(1,6).*3.*csi.^2 + c(3,6).*3.*csi.^2.*eta.^3 + c(4,6).*3.*csi.^2.*eta.^2 + c(5,6).*3.*csi.^2.*eta + c(6,6).*eta.^3 + c(7,6).*2.*csi.*eta.^3 + c(8,6).*2.*csi + c(10,6).*2.*csi.*eta.^2 + c(11,6).*2.*csi.*eta + c(12,6).*eta.^2 + c(13,6) + c(15,6).*eta + 0 ',...
                   'c(1,7).*3.*csi.^2 + c(3,7).*3.*csi.^2.*eta.^3 + c(4,7).*3.*csi.^2.*eta.^2 + c(5,7).*3.*csi.^2.*eta + c(6,7).*eta.^3 + c(7,7).*2.*csi.*eta.^3 + c(8,7).*2.*csi + c(10,7).*2.*csi.*eta.^2 + c(11,7).*2.*csi.*eta + c(12,7).*eta.^2 + c(13,7) + c(15,7).*eta + 0 ',...
                   'c(1,8).*3.*csi.^2 + c(3,8).*3.*csi.^2.*eta.^3 + c(4,8).*3.*csi.^2.*eta.^2 + c(5,8).*3.*csi.^2.*eta + c(6,8).*eta.^3 + c(7,8).*2.*csi.*eta.^3 + c(8,8).*2.*csi + c(10,8).*2.*csi.*eta.^2 + c(11,8).*2.*csi.*eta + c(12,8).*eta.^2 + c(13,8) + c(15,8).*eta + 0 ',...
                   'c(1,9).*3.*csi.^2 + c(3,9).*3.*csi.^2.*eta.^3 + c(4,9).*3.*csi.^2.*eta.^2 + c(5,9).*3.*csi.^2.*eta + c(6,9).*eta.^3 + c(7,9).*2.*csi.*eta.^3 + c(8,9).*2.*csi + c(10,9).*2.*csi.*eta.^2 + c(11,9).*2.*csi.*eta + c(12,9).*eta.^2 + c(13,9) + c(15,9).*eta + 0 ',...
                   'c(1,10).*3.*csi.^2 + c(3,10).*3.*csi.^2.*eta.^3 + c(4,10).*3.*csi.^2.*eta.^2 + c(5,10).*3.*csi.^2.*eta + c(6,10).*eta.^3 + c(7,10).*2.*csi.*eta.^3 + c(8,10).*2.*csi + c(10,10).*2.*csi.*eta.^2 + c(11,10).*2.*csi.*eta + c(12,10).*eta.^2 + c(13,10) + c(15,10).*eta + 0 ',...
                   'c(1,11).*3.*csi.^2 + c(3,11).*3.*csi.^2.*eta.^3 + c(4,11).*3.*csi.^2.*eta.^2 + c(5,11).*3.*csi.^2.*eta + c(6,11).*eta.^3 + c(7,11).*2.*csi.*eta.^3 + c(8,11).*2.*csi + c(10,11).*2.*csi.*eta.^2 + c(11,11).*2.*csi.*eta + c(12,11).*eta.^2 + c(13,11) + c(15,11).*eta + 0 ',...
                   'c(1,12).*3.*csi.^2 + c(3,12).*3.*csi.^2.*eta.^3 + c(4,12).*3.*csi.^2.*eta.^2 + c(5,12).*3.*csi.^2.*eta + c(6,12).*eta.^3 + c(7,12).*2.*csi.*eta.^3 + c(8,12).*2.*csi + c(10,12).*2.*csi.*eta.^2 + c(11,12).*2.*csi.*eta + c(12,12).*eta.^2 + c(13,12) + c(15,12).*eta + 0 ',...
                   'c(1,13).*3.*csi.^2 + c(3,13).*3.*csi.^2.*eta.^3 + c(4,13).*3.*csi.^2.*eta.^2 + c(5,13).*3.*csi.^2.*eta + c(6,13).*eta.^3 + c(7,13).*2.*csi.*eta.^3 + c(8,13).*2.*csi + c(10,13).*2.*csi.*eta.^2 + c(11,13).*2.*csi.*eta + c(12,13).*eta.^2 + c(13,13) + c(15,13).*eta + 0 ',...
                   'c(1,14).*3.*csi.^2 + c(3,14).*3.*csi.^2.*eta.^3 + c(4,14).*3.*csi.^2.*eta.^2 + c(5,14).*3.*csi.^2.*eta + c(6,14).*eta.^3 + c(7,14).*2.*csi.*eta.^3 + c(8,14).*2.*csi + c(10,14).*2.*csi.*eta.^2 + c(11,14).*2.*csi.*eta + c(12,14).*eta.^2 + c(13,14) + c(15,14).*eta + 0 ',...
                   'c(1,15).*3.*csi.^2 + c(3,15).*3.*csi.^2.*eta.^3 + c(4,15).*3.*csi.^2.*eta.^2 + c(5,15).*3.*csi.^2.*eta + c(6,15).*eta.^3 + c(7,15).*2.*csi.*eta.^3 + c(8,15).*2.*csi + c(10,15).*2.*csi.*eta.^2 + c(11,15).*2.*csi.*eta + c(12,15).*eta.^2 + c(13,15) + c(15,15).*eta + 0 ',...
                   'c(1,16).*3.*csi.^2 + c(3,16).*3.*csi.^2.*eta.^3 + c(4,16).*3.*csi.^2.*eta.^2 + c(5,16).*3.*csi.^2.*eta + c(6,16).*eta.^3 + c(7,16).*2.*csi.*eta.^3 + c(8,16).*2.*csi + c(10,16).*2.*csi.*eta.^2 + c(11,16).*2.*csi.*eta + c(12,16).*eta.^2 + c(13,16) + c(15,16).*eta + 0 '},...
                        'Gbasis_2',{'c(2,1).*3.*eta.^2 + c(3,1).*3.*eta.^2.*csi.^3 + c(4,1).*2.*eta.*csi.^3 + c(5,1).*csi.^3 + c(6,1).*3.*eta.^2.*csi + c(7,1).*3.*eta.^2.*csi.^2 + c(9,1).*2.*eta + c(10,1).*2.*eta.*csi.^2 + c(11,1).*csi.^2 + c(12,1).*2.*csi.*eta + c(14,1) + c(15,1).*csi',...
                   'c(2,2).*3.*eta.^2 + c(3,2).*3.*eta.^2.*csi.^3 + c(4,2).*2.*eta.*csi.^3 + c(5,2).*csi.^3 + c(6,2).*3.*eta.^2.*csi + c(7,2).*3.*eta.^2.*csi.^2 + c(9,2).*2.*eta + c(10,2).*2.*eta.*csi.^2 + c(11,2).*csi.^2 + c(12,2).*2.*csi.*eta + c(14,2) + c(15,2).*csi',...
                   'c(2,3).*3.*eta.^2 + c(3,3).*3.*eta.^2.*csi.^3 + c(4,3).*2.*eta.*csi.^3 + c(5,3).*csi.^3 + c(6,3).*3.*eta.^2.*csi + c(7,3).*3.*eta.^2.*csi.^2 + c(9,3).*2.*eta + c(10,3).*2.*eta.*csi.^2 + c(11,3).*csi.^2 + c(12,3).*2.*csi.*eta + c(14,3) + c(15,3).*csi',...
                   'c(2,4).*3.*eta.^2 + c(3,4).*3.*eta.^2.*csi.^3 + c(4,4).*2.*eta.*csi.^3 + c(5,4).*csi.^3 + c(6,4).*3.*eta.^2.*csi + c(7,4).*3.*eta.^2.*csi.^2 + c(9,4).*2.*eta + c(10,4).*2.*eta.*csi.^2 + c(11,4).*csi.^2 + c(12,4).*2.*csi.*eta + c(14,4) + c(15,4).*csi',...
                   'c(2,5).*3.*eta.^2 + c(3,5).*3.*eta.^2.*csi.^3 + c(4,5).*2.*eta.*csi.^3 + c(5,5).*csi.^3 + c(6,5).*3.*eta.^2.*csi + c(7,5).*3.*eta.^2.*csi.^2 + c(9,5).*2.*eta + c(10,5).*2.*eta.*csi.^2 + c(11,5).*csi.^2 + c(12,5).*2.*csi.*eta + c(14,5) + c(15,5).*csi',...
                   'c(2,6).*3.*eta.^2 + c(3,6).*3.*eta.^2.*csi.^3 + c(4,6).*2.*eta.*csi.^3 + c(5,6).*csi.^3 + c(6,6).*3.*eta.^2.*csi + c(7,6).*3.*eta.^2.*csi.^2 + c(9,6).*2.*eta + c(10,6).*2.*eta.*csi.^2 + c(11,6).*csi.^2 + c(12,6).*2.*csi.*eta + c(14,6) + c(15,6).*csi',...
                   'c(2,7).*3.*eta.^2 + c(3,7).*3.*eta.^2.*csi.^3 + c(4,7).*2.*eta.*csi.^3 + c(5,7).*csi.^3 + c(6,7).*3.*eta.^2.*csi + c(7,7).*3.*eta.^2.*csi.^2 + c(9,7).*2.*eta + c(10,7).*2.*eta.*csi.^2 + c(11,7).*csi.^2 + c(12,7).*2.*csi.*eta + c(14,7) + c(15,7).*csi',...
                   'c(2,8).*3.*eta.^2 + c(3,8).*3.*eta.^2.*csi.^3 + c(4,8).*2.*eta.*csi.^3 + c(5,8).*csi.^3 + c(6,8).*3.*eta.^2.*csi + c(7,8).*3.*eta.^2.*csi.^2 + c(9,8).*2.*eta + c(10,8).*2.*eta.*csi.^2 + c(11,8).*csi.^2 + c(12,8).*2.*csi.*eta + c(14,8) + c(15,8).*csi',...
                   'c(2,9).*3.*eta.^2 + c(3,9).*3.*eta.^2.*csi.^3 + c(4,9).*2.*eta.*csi.^3 + c(5,9).*csi.^3 + c(6,9).*3.*eta.^2.*csi + c(7,9).*3.*eta.^2.*csi.^2 + c(9,9).*2.*eta + c(10,9).*2.*eta.*csi.^2 + c(11,9).*csi.^2 + c(12,9).*2.*csi.*eta + c(14,9) + c(15,9).*csi',...
                   'c(2,10).*3.*eta.^2 + c(3,10).*3.*eta.^2.*csi.^3 + c(4,10).*2.*eta.*csi.^3 + c(5,10).*csi.^3 + c(6,10).*3.*eta.^2.*csi + c(7,10).*3.*eta.^2.*csi.^2 + c(9,10).*2.*eta + c(10,10).*2.*eta.*csi.^2 + c(11,10).*csi.^2 + c(12,10).*2.*csi.*eta + c(14,10) + c(15,10).*csi',...
                   'c(2,11).*3.*eta.^2 + c(3,11).*3.*eta.^2.*csi.^3 + c(4,11).*2.*eta.*csi.^3 + c(5,11).*csi.^3 + c(6,11).*3.*eta.^2.*csi + c(7,11).*3.*eta.^2.*csi.^2 + c(9,11).*2.*eta + c(10,11).*2.*eta.*csi.^2 + c(11,11).*csi.^2 + c(12,11).*2.*csi.*eta + c(14,11) + c(15,11).*csi',...
                   'c(2,12).*3.*eta.^2 + c(3,12).*3.*eta.^2.*csi.^3 + c(4,12).*2.*eta.*csi.^3 + c(5,12).*csi.^3 + c(6,12).*3.*eta.^2.*csi + c(7,12).*3.*eta.^2.*csi.^2 + c(9,12).*2.*eta + c(10,12).*2.*eta.*csi.^2 + c(11,12).*csi.^2 + c(12,12).*2.*csi.*eta + c(14,12) + c(15,12).*csi',...
                   'c(2,13).*3.*eta.^2 + c(3,13).*3.*eta.^2.*csi.^3 + c(4,13).*2.*eta.*csi.^3 + c(5,13).*csi.^3 + c(6,13).*3.*eta.^2.*csi + c(7,13).*3.*eta.^2.*csi.^2 + c(9,13).*2.*eta + c(10,13).*2.*eta.*csi.^2 + c(11,13).*csi.^2 + c(12,13).*2.*csi.*eta + c(14,13) + c(15,13).*csi',...
                   'c(2,14).*3.*eta.^2 + c(3,14).*3.*eta.^2.*csi.^3 + c(4,14).*2.*eta.*csi.^3 + c(5,14).*csi.^3 + c(6,14).*3.*eta.^2.*csi + c(7,14).*3.*eta.^2.*csi.^2 + c(9,14).*2.*eta + c(10,14).*2.*eta.*csi.^2 + c(11,14).*csi.^2 + c(12,14).*2.*csi.*eta + c(14,14) + c(15,14).*csi',...
                   'c(2,15).*3.*eta.^2 + c(3,15).*3.*eta.^2.*csi.^3 + c(4,15).*2.*eta.*csi.^3 + c(5,15).*csi.^3 + c(6,15).*3.*eta.^2.*csi + c(7,15).*3.*eta.^2.*csi.^2 + c(9,15).*2.*eta + c(10,15).*2.*eta.*csi.^2 + c(11,15).*csi.^2 + c(12,15).*2.*csi.*eta + c(14,15) + c(15,15).*csi',...
                   'c(2,16).*3.*eta.^2 + c(3,16).*3.*eta.^2.*csi.^3 + c(4,16).*2.*eta.*csi.^3 + c(5,16).*csi.^3 + c(6,16).*3.*eta.^2.*csi + c(7,16).*3.*eta.^2.*csi.^2 + c(9,16).*2.*eta + c(10,16).*2.*eta.*csi.^2 + c(11,16).*csi.^2 + c(12,16).*2.*csi.*eta + c(14,16) + c(15,16).*csi'});
               
    otherwise
        error('fem can only be P1-P2-P3-Q1-Q2-Q3');
end


